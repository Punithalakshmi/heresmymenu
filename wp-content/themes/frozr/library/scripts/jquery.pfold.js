/**
 * jquery.pfold.js v1.0.0
 * http://www.codrops.com
 *
 * Licensed under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 * 
 * Copyright 2012, Codrops
 * http://www.codrops.com
 */
!function(a,b){"use strict";var e,f,d=a.event;e=d.special.debouncedresize={setup:function(){a(this).on("resize",e.handler)},teardown:function(){a(this).off("resize",e.handler)},handler:function(a,b){var c=this,g=arguments,h=function(){a.type="debouncedresize",d.dispatch.apply(c,g)};f&&clearTimeout(f),b?h():f=setTimeout(h,e.threshold)},threshold:50};var g=a(b),h=b.Modernizr;a.PFold=function(b,c){this.$el=a(c),this._init(b)},a.PFold.defaults={perspective:1200,speed:450,easing:"linear",folddelay:0,folds:2,folddirection:["right","top"],overlays:!0,centered:!1,containerSpeedFactor:1,containerEasing:"linear",onEndFolding:function(){return!1},onEndUnfolding:function(){return!1}},a.PFold.prototype={_init:function(b){this.options=a.extend(!0,{},a.PFold.defaults,b),this.transEndEventNames={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},this.transEndEventName=this.transEndEventNames[h.prefixed("transition")],this.support=h.csstransitions&&h.csstransforms3d,this.support&&(this.$el.css("perspective",this.options.perspective+"px"),this.$el.css("transition","all "+this.options.speed*this.options.folds*this.options.containerSpeedFactor+"ms "+this.options.containerEasing)),this.initialDim={width:this.$el.width(),height:this.$el.height(),left:0,top:0},this._layout(),this.$iContent=this.$el.find(".uc-initial"),this.iContent=this.$iContent.html(),this.$fContent=this.$el.find(".uc-final"),this.fContent=this.$fContent.html(),this.$finalEl=a('<div class="uc-final-wrapper"></div>').append(this.$iContent.clone().hide(),this.$fContent).hide(),this.$el.append(this.$finalEl),this._setDimOffset(),this.opened=!1,this.animating=!1,this._initEvents()},_layout:function(){var b=this.$el.children("div.uc-initial-content"),c=this._getFinalDim(),d=this.$el.children("div.uc-final-content").css({width:c.width,height:c.height});b.wrap('<div class="uc-initial"></div>'),d.show().wrap(a('<div class="uc-final"></div>'))},_initEvents:function(){var a=this;g.on("debouncedresize.pfold",function(){a._setDimOffset()})},_setDimOffset:function(){this.initialDim.offsetL=this.$el.offset().left-g.scrollLeft(),this.initialDim.offsetT=this.$el.offset().top-g.scrollTop(),this.initialDim.offsetR=g.width()-this.initialDim.offsetL-this.initialDim.width,this.initialDim.offsetB=g.height()-this.initialDim.offsetT-this.initialDim.height},_getTranslationValue:function(){for(var a=0,b=0,c=0,d=0,e=0;e<this.options.folds;++e){var f=this.options.folddirection[e]||"bottom";switch(f){case"left":a+=this.initialDim.width*Math.pow(2,c)/2,c+=1;break;case"right":a-=this.initialDim.width*Math.pow(2,c)/2,c+=1;break;case"top":b+=this.initialDim.height*Math.pow(2,d)/2,d+=1;break;case"bottom":b-=this.initialDim.height*Math.pow(2,d)/2,d+=1}}return{x:a,y:b}},_getAccumulatedValue:function(){for(var a=0,b=0,c=0,d=0,e=0,f=0,g=0;g<this.options.folds;++g){var h=this.options.folddirection[g]||"bottom";switch(h){case"left":a+=this.initialDim.width*Math.pow(2,e),e+=1;break;case"right":b+=this.initialDim.width*Math.pow(2,e),e+=1;break;case"top":c+=this.initialDim.height*Math.pow(2,f),f+=1;break;case"bottom":d+=this.initialDim.height*Math.pow(2,f),f+=1}}return{l:a,r:b,t:c,b:d}},_getFinalDim:function(){for(var e=0,f=0,g=0;g<this.options.folds;++g){var h=this.options.folddirection[g]||"bottom";switch(h){case"left":case"right":e+=1;break;case"top":case"bottom":f+=1}}return{width:this.initialDim.width*Math.pow(2,e),height:this.initialDim.height*Math.pow(2,f)}},_updateStepStyle:function(a){var b,c,d,e;return"fold"===a?(b="left"===this.lastDirection||"right"===this.lastDirection?this.lastStyle.width/2:this.lastStyle.width,c="left"===this.lastDirection||"right"===this.lastDirection?this.lastStyle.height:this.lastStyle.height/2,d="left"===this.lastDirection?this.lastStyle.left+this.lastStyle.width/2:this.lastStyle.left,e="top"===this.lastDirection?this.lastStyle.top+this.lastStyle.height/2:this.lastStyle.top):(b="left"===this.lastDirection||"right"===this.lastDirection?2*this.lastStyle.width:this.lastStyle.width,c="left"===this.lastDirection||"right"===this.lastDirection?this.lastStyle.height:2*this.lastStyle.height,d="left"===this.lastDirection?this.lastStyle.left-this.lastStyle.width:this.lastStyle.left,e="top"===this.lastDirection?this.lastStyle.top-this.lastStyle.height:this.lastStyle.top),{width:b,height:c,left:d,top:e}},_getOppositeDirection:function(a){var b;switch(a){case"left":b="right";break;case"right":b="left";break;case"top":b="bottom";break;case"bottom":b="top"}return b},_start:function(b,c){c|=0;var d=this,e="fold"===b?{width:this.lastStyle.width,height:this.lastStyle.height,left:this.lastStyle.left,top:this.lastStyle.top}:this.initialDim,f="",g="",h="",i="fold"===b?this.options.folddirection[this.options.folds-1-c]||"bottom":this.options.folddirection[c]||"bottom",j="fold"===b?this.options.folddirection[this.options.folds-2-c]||"bottom":"";switch(this.$el.find("div.uc-part").remove(),c){case 0:case this.options.folds-1:if("fold"===b){if(c===this.options.folds-1&&(e=this.initialDim,f=this.iContent),0===c){this._setDimOffset(),this.$el.css({left:0,top:0});var k=this._setLastStep(i,e),g=k.bottom,h=k.top;this.$finalEl.hide().children().hide()}}else{if(0===c){this._setDimOffset();var l=this._getTranslationViewport();this.$el.addClass("uc-current").css({left:l.ftx,top:l.fty}),f=this.iContent,this.$finalEl.hide().children().hide()}else e=this._updateStepStyle(b);if(c===this.options.folds-1)var k=this._setLastStep(i,e),g=k.bottom,h=k.top}break;case this.options.folds:e="fold"===b?this.initialDim:this._updateStepStyle(b);var m="fold"===b?0:1;return this.$el.find(".uc-part").remove(),this.$finalEl.css(e).show().children().eq(m).show(),this.opened="fold"===b?!1:!0,this.animating=!1,"fold"===b?(this.$el.removeClass("uc-current"),this.options.onEndFolding()):this.options.onEndUnfolding(),!1;default:e=this._updateStepStyle(b)}this.support&&(e.transition="all "+this.options.speed+"ms "+this.options.easing);var n="uc-unfold-"+i,o="fold"===b?"uc-unfold uc-part "+n:"uc-part "+n,p=a('<div class="'+o+'"><div class="uc-front">'+f+'</div><div class="uc-back">'+h+"</div></div>").css(e),q=a('<div class="uc-part uc-single">'+g+"</div>").css(e);this.lastDirection="fold"===b?j:i,this.lastStyle=e,this.$el.append(q,p),this.options.overlays&&this.support&&this._addOverlays(b,q,p),setTimeout(function(){if("fold"===b?p.removeClass("uc-unfold"):p.addClass("uc-unfold"),d.support?p.on(d.transEndEventName,function(a){"uc-flipoverlay"!==a.target.className&&c<d.options.folds&&setTimeout(function(){d._start(b,c+1)},d.options.folddelay)}):d._start(b,c+1),d.options.overlays&&d.support){var a="fold"===b?1:0,e="fold"===b?.5:0,f="fold"===b?0:.5;d.$bottomOverlay.css("opacity",a),d.$topBackOverlay.css("opacity",e),d.$topFrontOverlay.css("opacity",f)}},30)},_getTranslationViewport:function(){var a=this._getAccumulatedValue(),b=0,c=0;this.fOffsetL=this.initialDim.offsetL-a.l,this.fOffsetT=this.initialDim.offsetT-a.t,this.fOffsetR=this.initialDim.offsetR-a.r,this.fOffsetB=this.initialDim.offsetB-a.b,this.fOffsetL<0&&(b=Math.abs(this.fOffsetL)),this.fOffsetT<0&&(c=Math.abs(this.fOffsetT)),this.fOffsetR<0&&(b-=Math.abs(this.fOffsetR)),this.fOffsetB<0&&(c-=Math.abs(this.fOffsetB));var d=b,e=c;if(this.options.centered){var f=this._getTranslationValue();d=f.x>0&&this.fOffsetR+f.x>=0?this.fOffsetL>=0?Math.min(f.x,this.fOffsetR):f.x+(b-f.x):f.x<0&&this.fOffsetL+f.x>=0&&this.fOffsetR>=0?Math.min(f.x,this.fOffsetL):f.x+(b-f.x),e=f.y>0&&this.fOffsetB+f.y>=0?this.fOffsetT>=0?Math.min(f.y,this.fOffsetB):f.y+(c-f.y):f.y<0&&this.fOffsetT+f.y>=0&&this.fOffsetB>=0?Math.min(f.y,this.fOffsetT):f.y+(c-f.y)}return{ftx:d,fty:e}},_setLastStep:function(a,b){var c,d,e="",f="";switch(a){case"bottom":f="margin-top: -"+b.height+"px";break;case"top":e="margin-top: -"+b.height+"px";break;case"left":f="width:"+2*b.width+"px",e="width:"+2*b.width+"px;margin-left: -"+b.width+"px";break;case"right":f="with:"+2*b.width+"px;margin-left: -"+b.width+"px",e="width:"+2*b.width+"px"}c='<div class="uc-inner"><div class="uc-inner-content" style="'+e+'">'+this.fContent+"</div></div>";var g="top"===a||"bottom"===a?"uc-inner uc-inner-rotate":"uc-inner";return d='<div class="'+g+'"><div class="uc-inner-content" style="'+f+'">'+this.fContent+"</div></div>",{bottom:c,top:d}},_addOverlays:function(b,c,d){var e,f,g;this.$bottomOverlay=a('<div class="uc-overlay"></div>'),this.$topFrontOverlay=a('<div class="uc-flipoverlay"></div>'),this.$topBackOverlay=a('<div class="uc-flipoverlay"></div>'),"fold"===b?(e={transition:"opacity "+this.options.speed/2+"ms "+this.options.easing+" "+this.options.speed/2+"ms"},f={opacity:.5,transition:"opacity "+this.options.speed/2+"ms "+this.options.easing},g={opacity:0,transition:"opacity "+this.options.speed/2+"ms "+this.options.easing}):(e={opacity:1,transition:"opacity "+this.options.speed/2+"ms "+this.options.easing},f={transition:"opacity "+this.options.speed/2+"ms "+this.options.easing},g={opacity:.5,transition:"opacity "+this.options.speed/2+"ms "+this.options.easing+" "+this.options.speed/2+"ms"}),c.append(this.$bottomOverlay.css(e)),d.children("div.uc-front").append(this.$topFrontOverlay.css(f)).end().children("div.uc-back").append(this.$topBackOverlay.css(g))},unfold:function(){return this.opened||this.animating?!1:(this.animating=!0,void this._start("unfold"))},fold:function(){return!this.opened||this.animating?!1:(this.animating=!0,void this._start("fold"))},getStatus:function(){return this.opened?"opened":"closed"}};var i=function(a){b.console&&b.console.error(a)};a.fn.pfold=function(b){var c=a.data(this,"pfold");if("string"===typeof b){var d=Array.prototype.slice.call(arguments,1);this.each(function(){return c?a.isFunction(c[b])&&"_"!==b.charAt(0)?void c[b].apply(c,d):void i("no such method '"+b+"' for pfold instance"):void i("cannot call methods on pfold prior to initialization; attempted to call method '"+b+"'")})}else this.each(function(){c?c._init():c=a.data(this,"pfold",new a.PFold(b,this))});return c}}(jQuery,window);